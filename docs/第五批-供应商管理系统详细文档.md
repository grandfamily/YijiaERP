# ç¬¬äº”æ‰¹-ä¾›åº”å•†ç®¡ç†ç³»ç»Ÿè¯¦ç»†æ–‡æ¡£

## ğŸ¤ 3. ä¾›åº”å•†ç®¡ç†ç³»ç»Ÿ (`suppliers/`)

### 3.1 æ¨¡å—æ¦‚è¿°
ä¾›åº”å•†ç®¡ç†ç³»ç»Ÿè´Ÿè´£ä¾›åº”å•†æ¡£æ¡ˆç®¡ç†ã€è¯„ä¼°ä¸åˆ†çº§ã€åˆåŒç®¡ç†å’Œç»©æ•ˆç›‘æ§ã€‚

### 3.2 TypeScript ç±»å‹å®šä¹‰

```typescript
// src/types/suppliers.ts
export interface Supplier {
  id: string;
  code: string;
  name: string;
  shortName: string;
  type: SupplierType;
  category: SupplierCategory;
  status: SupplierStatus;
  
  // åŸºæœ¬ä¿¡æ¯
  contactInfo: ContactInfo;
  address: Address;
  businessInfo: BusinessInfo;
  
  // èµ„è´¨ä¿¡æ¯
  qualifications: Qualification[];
  certifications: Certification[];
  
  // è¯„ä¼°ä¿¡æ¯
  rating: SupplierRating;
  evaluations: SupplierEvaluation[];
  
  // åˆä½œä¿¡æ¯
  contracts: Contract[];
  paymentTerms: PaymentTerms;
  deliveryTerms: DeliveryTerms;
  
  // ç³»ç»Ÿä¿¡æ¯
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
}

export type SupplierType = 'manufacturer' | 'distributor' | 'service_provider' | 'trading_company';
export type SupplierCategory = 'strategic' | 'preferred' | 'approved' | 'blacklist';
export type SupplierStatus = 'active' | 'inactive' | 'suspended' | 'under_review';

export interface ContactInfo {
  primaryContact: Contact;
  secondaryContact?: Contact;
  salesContact?: Contact;
  technicalContact?: Contact;
}

export interface Contact {
  name: string;
  title: string;
  email: string;
  phone: string;
  mobile?: string;
}

export interface Address {
  street: string;
  city: string;
  province: string;
  postalCode: string;
  country: string;
}

export interface BusinessInfo {
  registrationNumber: string;
  taxId: string;
  legalRepresentative: string;
  registeredCapital: number;
  establishedDate: Date;
  businessScope: string;
  bankInfo: BankInfo;
}

export interface BankInfo {
  bankName: string;
  accountNumber: string;
  accountName: string;
  swiftCode?: string;
}

export interface Qualification {
  id: string;
  type: QualificationType;
  name: string;
  number: string;
  issuedBy: string;
  issuedDate: Date;
  expiryDate?: Date;
  status: QualificationStatus;
  documentUrl?: string;
}

export type QualificationType = 'business_license' | 'tax_registration' | 'quality_cert' | 'safety_cert' | 'other';
export type QualificationStatus = 'valid' | 'expired' | 'pending_renewal' | 'revoked';

export interface Certification {
  id: string;
  name: string;
  standard: string;
  certifyingBody: string;
  issuedDate: Date;
  expiryDate?: Date;
  scope: string;
  status: CertificationStatus;
  documentUrl?: string;
}

export type CertificationStatus = 'valid' | 'expired' | 'suspended' | 'pending';

export interface SupplierRating {
  overall: number; // 1-5
  quality: number;
  delivery: number;
  service: number;
  cost: number;
  lastUpdated: Date;
  evaluationCount: number;
}

export interface SupplierEvaluation {
  id: string;
  supplierId: string;
  evaluatorId: string;
  evaluator: User;
  period: EvaluationPeriod;
  
  // è¯„ä¼°æŒ‡æ ‡
  qualityScore: number;
  deliveryScore: number;
  serviceScore: number;
  costScore: number;
  overallScore: number;
  
  // è¯¦ç»†è¯„ä¼°
  strengths: string[];
  weaknesses: string[];
  improvements: string[];
  recommendations: string[];
  
  // ä¸šç»©æ•°æ®
  performanceData: PerformanceData;
  
  // è¯„ä¼°ç»“æœ
  recommendation: EvaluationRecommendation;
  nextReviewDate: Date;
  
  status: EvaluationStatus;
  createdAt: Date;
  updatedAt: Date;
}

export interface EvaluationPeriod {
  startDate: Date;
  endDate: Date;
  type: 'monthly' | 'quarterly' | 'semi_annual' | 'annual';
}

export interface PerformanceData {
  totalOrders: number;
  totalValue: number;
  onTimeDeliveryRate: number;
  qualityAcceptanceRate: number;
  averageLeadTime: number;
  complaintCount: number;
  returnRate: number;
}

export type EvaluationRecommendation = 'promote' | 'maintain' | 'improve' | 'review' | 'terminate';
export type EvaluationStatus = 'draft' | 'submitted' | 'approved' | 'rejected';

export interface Contract {
  id: string;
  supplierId: string;
  contractNumber: string;
  type: ContractType;
  name: string;
  description: string;
  
  // åˆåŒæ¡æ¬¾
  terms: ContractTerms;
  
  // é‡‘é¢ä¿¡æ¯
  totalValue?: number;
  currency: string;
  
  // æ—¶é—´ä¿¡æ¯
  signedDate: Date;
  effectiveDate: Date;
  expiryDate: Date;
  
  // çŠ¶æ€ä¿¡æ¯
  status: ContractStatus;
  
  // æ–‡æ¡£ä¿¡æ¯
  documentUrl?: string;
  attachments: Attachment[];
  
  // ç»­çº¦ä¿¡æ¯
  autoRenewal: boolean;
  renewalNoticedays: number;
  
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
}

export type ContractType = 'framework' | 'specific' | 'service' | 'nda' | 'other';

export interface ContractTerms {
  paymentTerms: string;
  deliveryTerms: string;
  qualityStandards: string;
  penalties: string;
  warranties: string;
  specialTerms?: string;
}

export type ContractStatus = 'draft' | 'pending_signature' | 'active' | 'expired' | 'terminated' | 'suspended';

export interface PaymentTerms {
  method: PaymentMethod;
  currency: string;
  creditDays: number;
  discountTerms?: DiscountTerms;
  paymentSchedule?: PaymentSchedule[];
}

export interface DiscountTerms {
  percentage: number;
  days: number;
  description: string;
}

export interface PaymentSchedule {
  milestone: string;
  percentage: number;
  dueDate?: Date;
}

export interface DeliveryTerms {
  incoterm: string;
  leadTime: number;
  location: string;
  shippingMethod: string;
  packagingRequirements?: string;
}

export interface SupplierFilters {
  category: SupplierCategory[];
  status: SupplierStatus[];
  type: SupplierType[];
  rating: number;
  location: string;
  searchTerm: string;
}

export interface SupplierPerformanceMetrics {
  totalSuppliers: number;
  activeSuppliers: number;
  strategicSuppliers: number;
  averageRating: number;
  onTimeDeliveryRate: number;
  qualityAcceptanceRate: number;
  topPerformers: Supplier[];
  underPerformers: Supplier[];
  contractsExpiringsSoon: Contract[];
  certificationsExpiring: Certification[];
}
```

### 3.3 SupplierManagement ä¸»ç»„ä»¶

```typescript
// src/components/suppliers/SupplierManagement.tsx
import React, { useState, useEffect } from 'react';
import { toast } from 'react-hot-toast';
import {
  UserGroupIcon,
  DocumentTextIcon,
  ChartBarIcon,
  StarIcon,
  CogIcon,
  PlusIcon
} from '@heroicons/react/24/outline';

import { useSuppliers } from '../../hooks/useSuppliers';
import { useAuth } from '../../hooks/useAuth';
import { hasRolePermission } from '../../utils/permissions';
import {
  SupplierList,
  SupplierProfile,
  SupplierEvaluationForm,
  ContractManagement,
  SupplierPerformance,
  SupplierOverview,
  SupplierForm
} from './components';

interface SupplierManagementProps {
  activeTab?: SupplierTab;
}

type SupplierTab = 'overview' | 'list' | 'evaluations' | 'contracts' | 'performance' | 'settings';

const SupplierManagement: React.FC<SupplierManagementProps> = ({ activeTab = 'overview' }) => {
  const [currentTab, setCurrentTab] = useState<SupplierTab>(activeTab);
  const [selectedSupplier, setSelectedSupplier] = useState<string | null>(null);
  const [showSupplierForm, setShowSupplierForm] = useState(false);
  const [performanceMetrics, setPerformanceMetrics] = useState<SupplierPerformanceMetrics | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  // å…¨å±€çŠ¶æ€
  const suppliers = useSuppliers();
  const { user } = useAuth();

  // æƒé™æ£€æŸ¥
  const canManageSuppliers = hasRolePermission(user?.role || 'purchasing_officer', 'procurement_staff');
  const canEvaluateSuppliers = hasRolePermission(user?.role || 'purchasing_officer', 'department_manager');
  const canViewContracts = hasRolePermission(user?.role || 'purchasing_officer', 'procurement_staff');

  useEffect(() => {
    loadSupplierData();
  }, [suppliers]);

  const loadSupplierData = async () => {
    setIsLoading(true);
    try {
      // è®¡ç®—ä¾›åº”å•†ç»©æ•ˆæŒ‡æ ‡
      const metrics = calculatePerformanceMetrics();
      setPerformanceMetrics(metrics);

    } catch (error) {
      console.error('Failed to load supplier data:', error);
      toast.error('åŠ è½½ä¾›åº”å•†æ•°æ®å¤±è´¥');
    } finally {
      setIsLoading(false);
    }
  };

  const calculatePerformanceMetrics = (): SupplierPerformanceMetrics => {
    const totalSuppliers = suppliers.length;
    const activeSuppliers = suppliers.filter(s => s.status === 'active').length;
    const strategicSuppliers = suppliers.filter(s => s.category === 'strategic').length;
    
    // è®¡ç®—å¹³å‡è¯„åˆ†
    const suppliersWithRating = suppliers.filter(s => s.rating.evaluationCount > 0);
    const averageRating = suppliersWithRating.length > 0 
      ? suppliersWithRating.reduce((sum, s) => sum + s.rating.overall, 0) / suppliersWithRating.length
      : 0;

    // æ¨¡æ‹Ÿç»©æ•ˆæ•°æ®
    const onTimeDeliveryRate = 92.5;
    const qualityAcceptanceRate = 97.8;

    // è·å–è¡¨ç°ä¼˜ç§€å’Œä¸ä½³çš„ä¾›åº”å•†
    const topPerformers = suppliers
      .filter(s => s.rating.overall >= 4.0)
      .sort((a, b) => b.rating.overall - a.rating.overall)
      .slice(0, 5);

    const underPerformers = suppliers
      .filter(s => s.rating.overall < 3.0 && s.rating.evaluationCount > 0)
      .sort((a, b) => a.rating.overall - b.rating.overall)
      .slice(0, 5);

    // å³å°†åˆ°æœŸçš„åˆåŒ
    const now = new Date();
    const thirtyDaysFromNow = new Date(now.getTime() + 30 * 24 * 60 * 60 * 1000);
    
    const contractsExpiringsSoon = suppliers
      .flatMap(s => s.contracts)
      .filter(c => c.status === 'active' && new Date(c.expiryDate) <= thirtyDaysFromNow)
      .slice(0, 10);

    // å³å°†åˆ°æœŸçš„è®¤è¯
    const certificationsExpiring = suppliers
      .flatMap(s => s.certifications)
      .filter(c => c.expiryDate && new Date(c.expiryDate) <= thirtyDaysFromNow)
      .slice(0, 10);

    return {
      totalSuppliers,
      activeSuppliers,
      strategicSuppliers,
      averageRating,
      onTimeDeliveryRate,
      qualityAcceptanceRate,
      topPerformers,
      underPerformers,
      contractsExpiringsSoon,
      certificationsExpiring
    };
  };

  // åˆ›å»ºæ–°ä¾›åº”å•†
  const handleCreateSupplier = async (supplierData: Omit<Supplier, 'id' | 'createdAt' | 'updatedAt'>) => {
    try {
      const newSupplier: Supplier = {
        ...supplierData,
        id: generateId(),
        createdAt: new Date(),
        updatedAt: new Date()
      };

      addSupplier(newSupplier);
      setShowSupplierForm(false);
      toast.success('ä¾›åº”å•†åˆ›å»ºæˆåŠŸ');
    } catch (error) {
      console.error('Failed to create supplier:', error);
      toast.error('ä¾›åº”å•†åˆ›å»ºå¤±è´¥');
    }
  };

  // æ›´æ–°ä¾›åº”å•†ä¿¡æ¯
  const handleUpdateSupplier = async (supplierId: string, updates: Partial<Supplier>) => {
    try {
      updateSupplier(supplierId, {
        ...updates,
        updatedAt: new Date()
      });

      toast.success('ä¾›åº”å•†ä¿¡æ¯æ›´æ–°æˆåŠŸ');
    } catch (error) {
      console.error('Failed to update supplier:', error);
      toast.error('ä¾›åº”å•†ä¿¡æ¯æ›´æ–°å¤±è´¥');
    }
  };

  // æäº¤ä¾›åº”å•†è¯„ä¼°
  const handleSubmitEvaluation = async (evaluation: Omit<SupplierEvaluation, 'id' | 'createdAt' | 'updatedAt'>) => {
    try {
      const newEvaluation: SupplierEvaluation = {
        ...evaluation,
        id: generateId(),
        createdAt: new Date(),
        updatedAt: new Date()
      };

      // æ›´æ–°ä¾›åº”å•†è¯„åˆ†
      const supplier = suppliers.find(s => s.id === evaluation.supplierId);
      if (supplier) {
        const updatedRating = calculateUpdatedRating(supplier.rating, evaluation);
        await handleUpdateSupplier(supplier.id, {
          rating: updatedRating,
          evaluations: [...supplier.evaluations, newEvaluation]
        });
      }

      toast.success('ä¾›åº”å•†è¯„ä¼°æäº¤æˆåŠŸ');
    } catch (error) {
      console.error('Failed to submit evaluation:', error);
      toast.error('ä¾›åº”å•†è¯„ä¼°æäº¤å¤±è´¥');
    }
  };

  const calculateUpdatedRating = (currentRating: SupplierRating, newEvaluation: SupplierEvaluation): SupplierRating => {
    const totalEvaluations = currentRating.evaluationCount + 1;
    
    return {
      overall: ((currentRating.overall * currentRating.evaluationCount) + newEvaluation.overallScore) / totalEvaluations,
      quality: ((currentRating.quality * currentRating.evaluationCount) + newEvaluation.qualityScore) / totalEvaluations,
      delivery: ((currentRating.delivery * currentRating.evaluationCount) + newEvaluation.deliveryScore) / totalEvaluations,
      service: ((currentRating.service * currentRating.evaluationCount) + newEvaluation.serviceScore) / totalEvaluations,
      cost: ((currentRating.cost * currentRating.evaluationCount) + newEvaluation.costScore) / totalEvaluations,
      lastUpdated: new Date(),
      evaluationCount: totalEvaluations
    };
  };

  if (isLoading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"></div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* é¡µé¢æ ‡é¢˜ */}
      <div className="bg-white shadow">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="py-6">
            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-3xl font-bold text-gray-900">ä¾›åº”å•†ç®¡ç†</h1>
                <p className="mt-1 text-sm text-gray-500">
                  ç®¡ç†ä¾›åº”å•†æ¡£æ¡ˆã€è¯„ä¼°ç»©æ•ˆå’ŒåˆåŒä¿¡æ¯
                </p>
              </div>
              
              <div className="flex items-center space-x-4">
                {canManageSuppliers && (
                  <button
                    onClick={() => setShowSupplierForm(true)}
                    className="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                  >
                    <PlusIcon className="h-4 w-4 mr-2" />
                    æ–°å¢ä¾›åº”å•†
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* æ ‡ç­¾é¡µå¯¼èˆª */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="border-b border-gray-200">
          <nav className="-mb-px flex space-x-8" aria-label="Tabs">
            {[
              { key: 'overview', label: 'ä¾›åº”å•†æ¦‚è§ˆ', icon: ChartBarIcon },
              { key: 'list', label: 'ä¾›åº”å•†åˆ—è¡¨', icon: UserGroupIcon },
              { key: 'evaluations', label: 'ä¾›åº”å•†è¯„ä¼°', icon: StarIcon },
              { key: 'contracts', label: 'åˆåŒç®¡ç†', icon: DocumentTextIcon },
              { key: 'performance', label: 'ç»©æ•ˆç›‘æ§', icon: ChartBarIcon },
              { key: 'settings', label: 'ç³»ç»Ÿè®¾ç½®', icon: CogIcon }
            ].map((tab) => {
              const Icon = tab.icon;
              return (
                <button
                  key={tab.key}
                  onClick={() => setCurrentTab(tab.key as SupplierTab)}
                  className={`
                    group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm
                    ${currentTab === tab.key
                      ? 'border-blue-500 text-blue-600'
                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                    }
                  `}
                >
                  <Icon className={`
                    -ml-0.5 mr-2 h-5 w-5
                    ${currentTab === tab.key ? 'text-blue-500' : 'text-gray-400 group-hover:text-gray-500'}
                  `} />
                  {tab.label}
                  {tab.key === 'contracts' && performanceMetrics?.contractsExpiringsSoon.length && (
                    <span className="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      {performanceMetrics.contractsExpiringsSoon.length}
                    </span>
                  )}
                </button>
              );
            })}
          </nav>
        </div>
      </div>

      {/* å†…å®¹åŒºåŸŸ */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {currentTab === 'overview' && (
          <SupplierOverview 
            metrics={performanceMetrics}
            onRefresh={loadSupplierData}
            onSupplierSelect={setSelectedSupplier}
          />
        )}
        
        {currentTab === 'list' && (
          <SupplierList 
            suppliers={suppliers}
            onSupplierSelect={setSelectedSupplier}
            onSupplierUpdate={handleUpdateSupplier}
            canManage={canManageSuppliers}
          />
        )}
        
        {currentTab === 'evaluations' && canEvaluateSuppliers && (
          <SupplierEvaluationForm 
            suppliers={suppliers}
            onSubmitEvaluation={handleSubmitEvaluation}
          />
        )}
        
        {currentTab === 'contracts' && canViewContracts && (
          <ContractManagement 
            suppliers={suppliers}
            onContractUpdate={(contractId, updates) => {
              // æ›´æ–°åˆåŒé€»è¾‘
            }}
          />
        )}
        
        {currentTab === 'performance' && (
          <SupplierPerformance 
            suppliers={suppliers}
            metrics={performanceMetrics}
            onRefresh={loadSupplierData}
          />
        )}
        
        {currentTab === 'settings' && canManageSuppliers && (
          <SupplierSettings 
            onSettingsUpdate={(settings) => {
              // æ›´æ–°è®¾ç½®é€»è¾‘
            }}
          />
        )}
      </div>

      {/* ä¾›åº”å•†è¯¦æƒ…ä¾§è¾¹æ  */}
      {selectedSupplier && (
        <SupplierProfile 
          supplierId={selectedSupplier}
          onClose={() => setSelectedSupplier(null)}
          onUpdate={handleUpdateSupplier}
          canEdit={canManageSuppliers}
        />
      )}

      {/* æ–°å¢ä¾›åº”å•†æ¨¡æ€æ¡† */}
      {showSupplierForm && (
        <SupplierForm 
          onSave={handleCreateSupplier}
          onClose={() => setShowSupplierForm(false)}
        />
      )}
    </div>
  );
};

export default SupplierManagement;
```

### 3.4 SupplierOverview ä¾›åº”å•†æ¦‚è§ˆç»„ä»¶

```typescript
// src/components/suppliers/SupplierOverview.tsx
import React from 'react';
import {
  UserGroupIcon,
  StarIcon,
  TruckIcon,
  CheckCircleIcon,
  ExclamationTriangleIcon,
  DocumentTextIcon
} from '@heroicons/react/24/outline';

import { MetricCard, SupplierRatingChart, TopSuppliersTable } from '../ui';
import { formatNumber, formatPercentage } from '../../utils/format';

interface SupplierOverviewProps {
  metrics: SupplierPerformanceMetrics | null;
  onRefresh: () => void;
  onSupplierSelect: (supplierId: string) => void;
}

const SupplierOverview: React.FC<SupplierOverviewProps> = ({ 
  metrics, 
  onRefresh, 
  onSupplierSelect 
}) => {
  if (!metrics) {
    return (
      <div className="animate-pulse space-y-6">
        <div className="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
          {[...Array(6)].map((_, i) => (
            <div key={i} className="bg-white overflow-hidden shadow rounded-lg">
              <div className="p-5">
                <div className="h-4 bg-gray-300 rounded w-3/4"></div>
                <div className="mt-4 h-8 bg-gray-300 rounded w-1/2"></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* å…³é”®æŒ‡æ ‡å¡ç‰‡ */}
      <div className="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
        <MetricCard
          title="ä¾›åº”å•†æ€»æ•°"
          value={formatNumber(metrics.totalSuppliers)}
          subtitle={`æ´»è·ƒ ${metrics.activeSuppliers} å®¶`}
          icon={<UserGroupIcon className="h-6 w-6" />}
          color="blue"
        />
        
        <MetricCard
          title="æˆ˜ç•¥ä¾›åº”å•†"
          value={formatNumber(metrics.strategicSuppliers)}
          subtitle={`å æ¯” ${formatPercentage(metrics.strategicSuppliers / metrics.totalSuppliers)}`}
          icon={<StarIcon className="h-6 w-6" />}
          color="purple"
        />
        
        <MetricCard
          title="å¹³å‡è¯„åˆ†"
          value={metrics.averageRating.toFixed(1)}
          subtitle="æ»¡åˆ† 5.0"
          icon={<StarIcon className="h-6 w-6" />}
          color="yellow"
        />
        
        <MetricCard
          title="å‡†æ—¶äº¤ä»˜ç‡"
          value={formatPercentage(metrics.onTimeDeliveryRate / 100)}
          subtitle="æœ¬æœˆç»Ÿè®¡"
          icon={<TruckIcon className="h-6 w-6" />}
          color="green"
        />
        
        <MetricCard
          title="è´¨é‡åˆæ ¼ç‡"
          value={formatPercentage(metrics.qualityAcceptanceRate / 100)}
          subtitle="æœ¬æœˆç»Ÿè®¡"
          icon={<CheckCircleIcon className="h-6 w-6" />}
          color="green"
        />
        
        <MetricCard
          title="å³å°†åˆ°æœŸåˆåŒ"
          value={formatNumber(metrics.contractsExpiringsSoon.length)}
          subtitle="30å¤©å†…"
          icon={<DocumentTextIcon className="h-6 w-6" />}
          color="orange"
        />
      </div>

      {/* ä¾›åº”å•†è¯„åˆ†åˆ†å¸ƒå’Œè¡¨ç°æ’è¡Œ */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* ä¾›åº”å•†è¯„åˆ†åˆ†å¸ƒ */}
        <div className="bg-white overflow-hidden shadow rounded-lg">
          <div className="px-4 py-5 sm:p-6">
            <h3 className="text-lg leading-6 font-medium text-gray-900 mb-4">
              ä¾›åº”å•†è¯„åˆ†åˆ†å¸ƒ
            </h3>
            <SupplierRatingChart 
              suppliers={[...metrics.topPerformers, ...metrics.underPerformers]} 
            />
          </div>
        </div>

        {/* è¡¨ç°ä¼˜ç§€ä¾›åº”å•† */}
        <div className="bg-white overflow-hidden shadow rounded-lg">
          <div className="px-4 py-5 sm:p-6">
            <h3 className="text-lg leading-6 font-medium text-gray-900 mb-4">
              è¡¨ç°ä¼˜ç§€ä¾›åº”å•†
            </h3>
            <TopSuppliersTable 
              suppliers={metrics.topPerformers}
              onSupplierSelect={onSupplierSelect}
            />
          </div>
        </div>
      </div>

      {/* éœ€è¦å…³æ³¨çš„äº‹é¡¹ */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* è¡¨ç°ä¸ä½³ä¾›åº”å•† */}
        <div className="bg-white shadow overflow-hidden sm:rounded-md">
          <div className="px-4 py-5 sm:px-6 border-b border-gray-200">
            <div className="flex items-center">
              <ExclamationTriangleIcon className="h-5 w-5 text-yellow-400 mr-2" />
              <h3 className="text-lg leading-6 font-medium text-gray-900">
                éœ€è¦æ”¹è¿›çš„ä¾›åº”å•†
              </h3>
            </div>
          </div>
          <ul className="divide-y divide-gray-200">
            {metrics.underPerformers.map((supplier) => (
              <li key={supplier.id} className="px-4 py-4 sm:px-6">
                <div className="flex items-center justify-between">
                  <div className="flex-1 min-w-0">
                    <button
                      onClick={() => onSupplierSelect(supplier.id)}
                      className="text-sm font-medium text-blue-600 hover:text-blue-900 truncate"
                    >
                      {supplier.name}
                    </button>
                    <p className="text-sm text-gray-500">
                      è¯„åˆ†: {supplier.rating.overall.toFixed(1)} / 5.0
                    </p>
                  </div>
                  <div className="ml-4 flex-shrink-0">
                    <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      éœ€è¦å…³æ³¨
                    </span>
                  </div>
                </div>
              </li>
            ))}
          </ul>
          {metrics.underPerformers.length === 0 && (
            <div className="text-center py-6">
              <p className="text-sm text-gray-500">æš‚æ— è¡¨ç°ä¸ä½³çš„ä¾›åº”å•†</p>
            </div>
          )}
        </div>

        {/* å³å°†åˆ°æœŸçš„åˆåŒ */}
        <div className="bg-white shadow overflow-hidden sm:rounded-md">
          <div className="px-4 py-5 sm:px-6 border-b border-gray-200">
            <div className="flex items-center">
              <DocumentTextIcon className="h-5 w-5 text-orange-400 mr-2" />
              <h3 className="text-lg leading-6 font-medium text-gray-900">
                å³å°†åˆ°æœŸåˆåŒ
              </h3>
            </div>
          </div>
          <ul className="divide-y divide-gray-200">
            {metrics.contractsExpiringsSoon.map((contract) => (
              <li key={contract.id} className="px-4 py-4 sm:px-6">
                <div className="flex items-center justify-between">
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-medium text-gray-900 truncate">
                      {contract.name}
                    </p>
                    <p className="text-sm text-gray-500">
                      åˆ°æœŸæ—¥æœŸ: {formatDate(contract.expiryDate)}
                    </p>
                  </div>
                  <div className="ml-4 flex-shrink-0">
                    <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                      {getDaysUntilExpiry(contract.expiryDate)} å¤©
                    </span>
                  </div>
                </div>
              </li>
            ))}
          </ul>
          {metrics.contractsExpiringsSoon.length === 0 && (
            <div className="text-center py-6">
              <p className="text-sm text-gray-500">æš‚æ— å³å°†åˆ°æœŸçš„åˆåŒ</p>
            </div>
          )}
        </div>
      </div>

      {/* å³å°†åˆ°æœŸçš„è®¤è¯ */}
      {metrics.certificationsExpiring.length > 0 && (
        <div className="bg-white shadow overflow-hidden sm:rounded-md">
          <div className="px-4 py-5 sm:px-6 border-b border-gray-200">
            <div className="flex items-center justify-between">
              <div className="flex items-center">
                <ExclamationTriangleIcon className="h-5 w-5 text-red-400 mr-2" />
                <h3 className="text-lg leading-6 font-medium text-gray-900">
                  å³å°†åˆ°æœŸçš„è®¤è¯
                </h3>
              </div>
              <button
                onClick={onRefresh}
                className="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"
              >
                åˆ·æ–°
              </button>
            </div>
          </div>
          <ul className="divide-y divide-gray-200">
            {metrics.certificationsExpiring.map((certification) => (
              <li key={certification.id} className="px-4 py-4 sm:px-6">
                <div className="flex items-center justify-between">
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-medium text-gray-900 truncate">
                      {certification.name}
                    </p>
                    <p className="text-sm text-gray-500">
                      æ ‡å‡†: {certification.standard} | åˆ°æœŸ: {formatDate(certification.expiryDate!)}
                    </p>
                  </div>
                  <div className="ml-4 flex-shrink-0">
                    <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      {getDaysUntilExpiry(certification.expiryDate!)} å¤©
                    </span>
                  </div>
                </div>
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
};

// è¾…åŠ©å‡½æ•°
const getDaysUntilExpiry = (expiryDate: Date): number => {
  const now = new Date();
  const expiry = new Date(expiryDate);
  const diffTime = expiry.getTime() - now.getTime();
  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
};

export default SupplierOverview;
```

### 3.5 SupplierList ä¾›åº”å•†åˆ—è¡¨ç»„ä»¶

```typescript
// src/components/suppliers/SupplierList.tsx
import React, { useState, useMemo } from 'react';
import {
  StarIcon,
  MapPinIcon,
  PhoneIcon,
  EnvelopeIcon,
  EyeIcon,
  PencilIcon
} from '@heroicons/react/24/outline';

import { SupplierFilters, SupplierStatusBadge, SupplierCategoryBadge } from '../ui';
import { formatDate } from '../../utils/format';

interface SupplierListProps {
  suppliers: Supplier[];
  onSupplierSelect: (supplierId: string) => void;
  onSupplierUpdate: (supplierId: string, updates: Partial<Supplier>) => void;
  canManage: boolean;
}

const SupplierList: React.FC<SupplierListProps> = ({
  suppliers,
  onSupplierSelect,
  onSupplierUpdate,
  canManage
}) => {
  const [filteredSuppliers, setFilteredSuppliers] = useState<Supplier[]>([]);
  const [filters, setFilters] = useState<SupplierFilters>({
    category: [],
    status: [],
    type: [],
    rating: 0,
    location: '',
    searchTerm: ''
  });
  const [sortBy, setSortBy] = useState<'name' | 'rating' | 'createdAt'>('name');
  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');

  // åº”ç”¨ç­›é€‰å™¨
  React.useEffect(() => {
    let filtered = [...suppliers];

    if (filters.category.length > 0) {
      filtered = filtered.filter(supplier => filters.category.includes(supplier.category));
    }

    if (filters.status.length > 0) {
      filtered = filtered.filter(supplier => filters.status.includes(supplier.status));
    }

    if (filters.type.length > 0) {
      filtered = filtered.filter(supplier => filters.type.includes(supplier.type));
    }

    if (filters.rating > 0) {
      filtered = filtered.filter(supplier => supplier.rating.overall >= filters.rating);
    }

    if (filters.location) {
      filtered = filtered.filter(supplier => 
        supplier.address.city.toLowerCase().includes(filters.location.toLowerCase()) ||
        supplier.address.province.toLowerCase().includes(filters.location.toLowerCase())
      );
    }

    if (filters.searchTerm) {
      const searchLower = filters.searchTerm.toLowerCase();
      filtered = filtered.filter(supplier =>
        supplier.name.toLowerCase().includes(searchLower) ||
        supplier.code.toLowerCase().includes(searchLower) ||
        supplier.contactInfo.primaryContact.name.toLowerCase().includes(searchLower)
      );
    }

    // æ’åº
    filtered.sort((a, b) => {
      let aValue: any, bValue: any;
      
      switch (sortBy) {
        case 'name':
          aValue = a.name;
          bValue = b.name;
          break;
        case 'rating':
          aValue = a.rating.overall;
          bValue = b.rating.overall;
          break;
        case 'createdAt':
          aValue = new Date(a.createdAt);
          bValue = new Date(b.createdAt);
          break;
        default:
          aValue = a.name;
          bValue = b.name;
      }

      if (aValue < bValue) return sortOrder === 'asc' ? -1 : 1;
      if (aValue > bValue) return sortOrder === 'asc' ? 1 : -1;
      return 0;
    });

    setFilteredSuppliers(filtered);
  }, [suppliers, filters, sortBy, sortOrder]);

  const handleSort = (field: 'name' | 'rating' | 'createdAt') => {
    if (sortBy === field) {
      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');
    } else {
      setSortBy(field);
      setSortOrder('asc');
    }
  };

  const handleStatusChange = async (supplierId: string, newStatus: SupplierStatus) => {
    await onSupplierUpdate(supplierId, { status: newStatus });
  };

  // ç»Ÿè®¡æ•°æ®
  const stats = useMemo(() => {
    const total = filteredSuppliers.length;
    const active = filteredSuppliers.filter(s => s.status === 'active').length;
    const strategic = filteredSuppliers.filter(s => s.category === 'strategic').length;
    const avgRating = filteredSuppliers.length > 0
      ? filteredSuppliers.reduce((sum, s) => sum + s.rating.overall, 0) / filteredSuppliers.length
      : 0;

    return { total, active, strategic, avgRating };
  }, [filteredSuppliers]);

  return (
    <div className="space-y-6">
      {/* ç»Ÿè®¡æ¦‚è§ˆ */}
      <div className="bg-white p-6 rounded-lg shadow">
        <div className="grid grid-cols-1 gap-5 sm:grid-cols-4">
          <div className="text-center">
            <div className="text-2xl font-bold text-gray-900">{stats.total}</div>
            <div className="text-sm text-gray-500">æ€»ä¾›åº”å•†</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-green-600">{stats.active}</div>
            <div className="text-sm text-gray-500">æ´»è·ƒä¾›åº”å•†</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-purple-600">{stats.strategic}</div>
            <div className="text-sm text-gray-500">æˆ˜ç•¥ä¾›åº”å•†</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-yellow-600">{stats.avgRating.toFixed(1)}</div>
            <div className="text-sm text-gray-500">å¹³å‡è¯„åˆ†</div>
          </div>
        </div>
      </div>

      {/* ç­›é€‰å™¨ */}
      <div className="bg-white p-4 rounded-lg shadow">
        <SupplierFilters 
          filters={filters}
          onFiltersChange={setFilters}
        />
      </div>

      {/* ä¾›åº”å•†åˆ—è¡¨ */}
      <div className="bg-white shadow overflow-hidden sm:rounded-md">
        {/* æ’åºæ§åˆ¶ */}
        <div className="px-4 py-3 bg-gray-50 border-b border-gray-200">
          <div className="flex items-center justify-between">
            <span className="text-sm font-medium text-gray-700">
              å…± {filteredSuppliers.length} å®¶ä¾›åº”å•†
            </span>
            <div className="flex items-center space-x-4">
              <span className="text-sm text-gray-500">æ’åº:</span>
              <button
                onClick={() => handleSort('name')}
                className={`text-sm ${sortBy === 'name' ? 'text-blue-600 font-medium' : 'text-gray-500'}`}
              >
                åç§° {sortBy === 'name' && (sortOrder === 'asc' ? 'â†‘' : 'â†“')}
              </button>
              <button
                onClick={() => handleSort('rating')}
                className={`text-sm ${sortBy === 'rating' ? 'text-blue-600 font-medium' : 'text-gray-500'}`}
              >
                è¯„åˆ† {sortBy === 'rating' && (sortOrder === 'asc' ? 'â†‘' : 'â†“')}
              </button>
              <button
                onClick={() => handleSort('createdAt')}
                className={`text-sm ${sortBy === 'createdAt' ? 'text-blue-600 font-medium' : 'text-gray-500'}`}
              >
                åˆ›å»ºæ—¶é—´ {sortBy === 'createdAt' && (sortOrder === 'asc' ? 'â†‘' : 'â†“')}
              </button>
            </div>
          </div>
        </div>

        <ul className="divide-y divide-gray-200">
          {filteredSuppliers.map((supplier) => (
            <li key={supplier.id} className="px-4 py-6 hover:bg-gray-50">
              <div className="flex items-center justify-between">
                <div className="flex-1 min-w-0">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center">
                      <div className="flex-1 min-w-0">
                        <div className="flex items-center">
                          <button
                            onClick={() => onSupplierSelect(supplier.id)}
                            className="text-lg font-medium text-blue-600 hover:text-blue-900 truncate"
                          >
                            {supplier.name}
                          </button>
                          <span className="ml-2 text-sm text-gray-500">({supplier.code})</span>
                        </div>
                        
                        <div className="mt-1 flex items-center space-x-4">
                          <SupplierCategoryBadge category={supplier.category} />
                          <SupplierStatusBadge status={supplier.status} />
                          
                          <div className="flex items-center">
                            <StarIcon className="h-4 w-4 text-yellow-400 mr-1" />
                            <span className="text-sm text-gray-600">
                              {supplier.rating.overall.toFixed(1)} ({supplier.rating.evaluationCount} è¯„ä»·)
                            </span>
                          </div>
                        </div>

                        <div className="mt-2 grid grid-cols-1 gap-2 sm:grid-cols-3">
                          <div className="flex items-center text-sm text-gray-500">
                            <MapPinIcon className="h-4 w-4 mr-1" />
                            {supplier.address.city}, {supplier.address.province}
                          </div>
                          
                          <div className="flex items-center text-sm text-gray-500">
                            <PhoneIcon className="h-4 w-4 mr-1" />
                            {supplier.contactInfo.primaryContact.phone}
                          </div>
                          
                          <div className="flex items-center text-sm text-gray-500">
                            <EnvelopeIcon className="h-4 w-4 mr-1" />
                            {supplier.contactInfo.primaryContact.email}
                          </div>
                        </div>

                        <div className="mt-2 text-sm text-gray-500">
                          è”ç³»äºº: {supplier.contactInfo.primaryContact.name} ({supplier.contactInfo.primaryContact.title})
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="ml-6 flex items-center space-x-2">
                  {canManage && (
                    <select
                      value={supplier.status}
                      onChange={(e) => handleStatusChange(supplier.id, e.target.value as SupplierStatus)}
                      className="text-sm border border-gray-300 rounded-md px-2 py-1"
                    >
                      <option value="active">æ´»è·ƒ</option>
                      <option value="inactive">éæ´»è·ƒ</option>
                      <option value="suspended">æš‚åœ</option>
                      <option value="under_review">å®¡æ ¸ä¸­</option>
                    </select>
                  )}

                  <button
                    onClick={() => onSupplierSelect(supplier.id)}
                    className="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"
                  >
                    <EyeIcon className="h-4 w-4 mr-2" />
                    æŸ¥çœ‹
                  </button>

                  {canManage && (
                    <button
                      onClick={() => {/* ç¼–è¾‘ä¾›åº”å•† */}}
                      className="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"
                    >
                      <PencilIcon className="h-4 w-4 mr-2" />
                      ç¼–è¾‘
                    </button>
                  )}
                </div>
              </div>
            </li>
          ))}
        </ul>

        {filteredSuppliers.length === 0 && (
          <div className="text-center py-12">
            <UserGroupIcon className="mx-auto h-12 w-12 text-gray-400" />
            <h3 className="mt-2 text-sm font-medium text-gray-900">æ²¡æœ‰æ‰¾åˆ°ä¾›åº”å•†</h3>
            <p className="mt-1 text-sm text-gray-500">è¯·è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æ·»åŠ æ–°çš„ä¾›åº”å•†ã€‚</p>
          </div>
        )}
      </div>
    </div>
  );
};

export default SupplierList;
```

---

**ç¬¬äº”æ‰¹ä¾›åº”å•†ç®¡ç†æ¨¡å—è¯¦ç»†æ–‡æ¡£å·²å®Œæˆï¼**

æˆ‘å·²ç»åˆ›å»ºäº†å®Œæ•´çš„ä¾›åº”å•†ç®¡ç†ç³»ç»Ÿè¯¦ç»†æ–‡æ¡£ï¼ŒåŒ…å«ï¼š

1. **å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰**
2. **SupplierManagement ä¸»ç»„ä»¶**
3. **SupplierOverview ä¾›åº”å•†æ¦‚è§ˆç»„ä»¶**
4. **SupplierList ä¾›åº”å•†åˆ—è¡¨ç»„ä»¶**

è¯¥æ–‡æ¡£æä¾›äº†ä¾›åº”å•†ç®¡ç†çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

- ğŸ¢ ä¾›åº”å•†æ¡£æ¡ˆç®¡ç†
- ğŸ“Š ä¾›åº”å•†è¯„ä¼°ä¸åˆ†çº§
- ğŸ“„ åˆåŒç®¡ç†ä¸ç»­çº¦
- ğŸ“ˆ ä¾›åº”å•†ç»©æ•ˆç›‘æ§
- ğŸ” ä¾›åº”å•†ç­›é€‰ä¸æœç´¢
- âš ï¸ åˆåŒå’Œè®¤è¯åˆ°æœŸé¢„è­¦

æœ€åä¸€ä¸ªæ¨¡å—æ˜¯æŠ¥è¡¨ç³»ç»Ÿï¼Œéœ€è¦æˆ‘ç»§ç»­åˆ›å»ºæŠ¥è¡¨ç³»ç»Ÿçš„è¯¦ç»†æ–‡æ¡£å—ï¼Ÿ
